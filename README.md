# Experimental measurement of FPGA registers power consumption

In this experiment, I compare power consumption of flip-flop registers of various FPGA devices, using multiple consumer development boards.

No attempt is made to explain the results, based on the differences in density, LE structure, manufacturing technology, process nanometers or what have you, just the numbers. Make of it what you will.

# Methodology

For every device I compile the same VHDL program, which generates as many flip-flop registers as possible for that device, all forming up a chain. Every register in the chain passes its input to output at every tick, just like registers are supposed to. The chain is then fed with the half-rate pulse signal, which flips at every clock tick. Therefore, after the chain has flushed, every register will charge at tick N and discharge at tick N+1, releasing the accumulated energy as fast as possible.

I then measure the power drained from the USB power supply, subtract the idle wattage measured in reset state of the same program and divide by the number of registers in the chain. 

The result is therefore measured in "microwatts per register" and theoretically corresponds to energy consumed (released) by a single register, flipping at every clock tick. The lower numbers presumably mean better efficiency.

The experiment is repeated three times with different clock frequencies, specifically 10, 25 and 100 megahertz, generated by whatever PLL machinery the device provides. One of the good signs is that the observed numbers end up being linear with the frequency, just as you would expect.

This is how it looks like conceptually:

![Sketch](/images/power_draft.png)

And this is how it looks when synthesized (for a chain of 3 registers):

![Scheme](/images/power_tech.png)

The simulation source is available in this repository, and here is how the simulated waveform looks like, for a chain of 10 registers:

![Waveform](/images/power_waveform.png)

# Hardware

The following is the list of tested devices:

1. [Diymore](https://www.diymore.cc/products/eprom-5v-altera-fpga-cycloneii-ep2c5t144-minimum-system-development-board-usb-blaster-mini-usb-cable-10pin-jtag-connection-cable), Altera Cyclone II (EP2C5T144C8)
2. [Zrtech](https://www.youtube.com/watch?v=X9qC44bT3r4), Altera Cyclone IV (EP4CE6E22C8N)
3. [BeMicro-Max-10](https://community.intel.com/t5/FPGA-Wiki/BeMicro-Max-10/ta-p/735231), Altera Max 10 (10M08DAF484C8GES)
4. [Trenz-Electronic MAX1000](https://shop.trenz-electronic.de/en/TEI0001-03-16-C8A-MAX1000-IoT-Maker-Board-16-kLE-32-MByte-SDRAM), Altera Max 10 (10M16SAU169C8G)
5. [Trenz-Electronic CYC1000](https://shop.trenz-electronic.de/en/Products/Trenz-Electronic/CYC1000-Intel-Cyclone-10/), Intel Cyclone 10 (10CL025YU256C8G)
6. [Micro-Nova Mercury](https://www.micro-nova.com/mercury), Spartan 3A (XC3S200A5VQ100)
7. [OHO-Elektronik GODIL50](http://www.oho-elektronik.de/pics/UM_GODIL.pdf), Spartan 3E (XC3S500E4VQG100C)
8. [Numato Labs Mimas V2](https://numato.com/product/mimas-v2-spartan-6-fpga-development-board-with-ddr-sdram/), Spartan 6 (XC6SLX9CSG324)
9. [Digilent Cora Z7](https://digilent.com/reference/programmable-logic/cora-z7/start), Zynq 7000, (XC7Z007S1CLG400C)
10. [Digilent Cmod S7](https://digilent.com/reference/programmable-logic/cmod-s7/start), Spartan 7 (XC7S251CSGA225C)
11. [Digilent Cmod A7](https://digilent.com/reference/programmable-logic/cmod-a7/start), Artix 7 (XC7A35T1CPG236C)
12. [Lattice MachXO2 Pico](https://www.latticesemi.com/alpha-mxo2-pico-kit), Lattice Mach XO2 (LCMX02-1200ZE-1MG123I)
13. [Nandland Go Board](https://www.nandland.com/blog/go-board-introduction.html), Lattice iCE40 (iCE40HX1K)
14. [Trenz-Electronic LXO2000](https://shop.trenz-electronic.de/en/TEL0001-02-LXO2000-with-Lattice-XO2-4000-On-Board-USB/JTAG-2.5-x-6.15-cm), Lattice Mach XO2 (LCMXO2-4000HC-4QN84C)
15. [OrangeCrab](https://1bitsquared.com/products/orangecrab), Lattice ECP5 (LFE5U-25F-8MG285C)
16. [Radiona ULX3S](https://www.crowdsupply.com/radiona/ulx3s), Lattice ECP5 (LFE5U-85F-6BG381C)
17. [Tang Primer](https://tang.sipeed.com/en/), Anlogic EG4 (EG4S20BG256)
18. [Runber](https://www.seeedstudio.com/Gowin-RUNBER-Development-Board-p-4779.html), Gowin GW1N-4 (GW1N-UV4LQ144C6/I5)
19. [Trenz-Electronic TEC0117](https://shop.trenz-electronic.de/en/TEC0117-01-FPGA-Module-with-GOWIN-LittleBee-and-8-MByte-internal-SDRAM), Gowin GW1NR-9 (GW1NR-LV9QN88C6/I5)
20. [FireAnt](https://www.crowdsupply.com/jungle-elec/fireant), Efinix Trion T8 (T8F81)
21. [Trion T20](https://www.efinixinc.com/products-devkits-triont20.html), Efinix Trion T20 (T20F256)
22. [Trenz-Electronic SMF2000](https://shop.trenz-electronic.de/en/TEM0001-01A-010C-SMF2000-FPGA-Module-with-Microsemi-SmartFusion2-8-MByte-SDRAM), Microsemi SmartFusion2 (M2S010-VF400)

For power measurement [this device](https://www.amazon.de/-/en/gp/product/B07W6MWNMV/) was used (reports as Ruideng AT35 v.1.7 as it boots).

# The results

Here is the final table with the collected data. The devices are grouped by manufacturer, and the different frequencies are represented by the vertical blocks.

![Scheme](/images/power_table.png)

[download spreadsheet here](https://github.com/targeted/fpga-reg-power/blob/main/docs/power_data.ods?raw=true)

The following is the graph built from the data. The 100 Mhz column is probably the most useful, the rest is there just to demonstrate the linearity.

![Scheme](/images/power_graph.png)

# Notes

The Go Board is based on iCE40HX1K FPGA chip in VQ100 package, which doesn't have any PLLs. Therefore I could only run it at the 25 MHz the board oscillator provides.

And I absolutely cannot explain the results from the Runber device featuring Gowin 1N4 chip, it goes off the chart right away, for no apparent reason. Its TEC0117 sibling does just fine. Perhaps there is something wrong with the particular board, or the chip.
